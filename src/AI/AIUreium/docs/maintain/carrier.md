# carrier设计

进行搬运任务。

设置为role模式。拥有一个优先任务队列。

在每次执行完一个路径时，会自动计算任务列表中所有任务的优先级，并调出最高优先级的执行。

当然也可以执行role。这两个执行模式都需要提供一个返回值以告知执行完毕。这个返回值直接写入creep的global memory。

需要一个共通的任务队列，以支持多个同房间的carrier使用。 

## 任务类型

常见场景：

1. 搬运mineral的矿物到storage
2. 搬运power到powerSpawn
3. 在storage和lab之间搬运矿物和能量
4. 填充nuker
5. 填充tower
6. 捡取地上的resource

搬运source开采出的能量到storage，

和填充spawn和extension属于高频任务，由其他角色承担，

针对上面这些频率不高的任务设计一个通用carrier。

单次搬运的完成条件判定为，要么容器满了，要么carrier空了。

任务的触发条件判定可以为：
1. 源容器的物资量大于一定值，如大于carrier容量。
2. 目标容器的物资量小于一定值。


任务的完成条件判定可以为：

目标容器/源容器的物资达到要求。

看得出来，触发条件和完成条件是相对的，但不一定可以简化为单个判定。
比如我们希望tower能量为小于150的时候才发任务（即触发条件），但是该任务的完成条件为填满能量。

有一些任务需要连续执行，比如填充tower，有多个目标。
需要允许carrier在完成单次搬运后，检测自身物资并执行其他任务的运送。

达到任务的触发条件时，发送任务。
每次搬运完成时，判定一次完成条件。

需要一个任务量估计的方法，允许在任务量较多时多孵化一个carrier帮忙。

任务的参数有：
1. 源容器
2. 目标容器

注意，两个容器参数都可为多个容器的集合。按照一定规则来选取对应容器。

## 具体实现架构

